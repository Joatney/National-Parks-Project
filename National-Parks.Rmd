---
title: "National Parks"
author: "John Oatney, Gwen Wooten, Tommy Fowler"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

library(readr)
species <- read_csv("Biodiversity/species.csv")

library(readr)
parks <- read_csv("Biodiversity/parks.csv")

```

## Brainstorming
  #Map of National Park locations to give background information
  ##Question of whether species are endangered and whether they are native to recognize where to allocate resources. 
  ##Where should we allocate resources based on where endangered species are and whether the species are native or invasive? 
    #Map of endangered species

```{r message = FALSE}
##Tommy

##John

speciesendanger <- species %>% 
  filter(!is.na(`Conservation Status`), Occurrence != "Not Confirmed") %>% 
  filter(!Abundance %in% c("Native", "Not Native"))

speciesabundance <- species %>% 
  filter(!is.na(Abundance)) %>% 
  filter(!Abundance %in% c("Native", "Not Native")) %>% 
  group_by(Abundance, `Conservation Status`) %>% 
  summarize(count = n()) %>% 
  filter(`Conservation Status` == "Species of Concern")

specieslargeviz <- speciesendanger %>% 
  filter(!is.na(Abundance)) %>% 
  group_by(Abundance, `Conservation Status`) %>% 
  summarize(count = n()) %>% 
  filter(!is.na(`Conservation Status`))

speciesconservationviz <- speciesendanger %>% 
  group_by(`Conservation Status`) %>% 
  summarize(count = n()) %>% 
  filter(!is.na(`Conservation Status`)) %>% 
  arrange(desc(count))

speciesabundanceviz <- speciesendanger %>% 
  filter(!is.na(Abundance)) %>% 
  group_by(Abundance) %>% 
  summarize(count = n())

# Here is where my visualization begins!

ggplot(speciesconservationviz, aes(x = "", y = count, fill = reorder(`Conservation Status`, count))) +
  geom_bar(stat = "identity", width = 1, color = "white") + 
  coord_polar("y", start = 0) + 
  theme_void() + 
  scale_fill_manual(values = c("black", "#11CCDC", "#69EF7B", "#48A421", "#C7DD91", "#304F9B", "#BE3ACD", "#8F0F1B")) +
  labs(fill = "Conservation Status")

ggplot(speciesabundanceviz, aes(x = "", y = count, fill = reorder(Abundance, count))) + 
  geom_bar(stat = "identity", width = 1, color = "white") + 
  coord_polar("y", start = 0) + 
  theme_void() +
  scale_fill_manual(values = c("#84EE15", "#E4997F", "#284E37", "#56EBD3", "#A53460", "#99DEF9")) + 
  labs(fill = "Abundance")

ggplot(speciesabundanceviz, aes(x = reorder(Abundance, count), y = count, fill = Abundance)) + 
  geom_bar(stat = "identity", show.legend = FALSE) +
  theme_classic() +
  scale_fill_manual(values = c("#84EE15", "#56EBD3", "#E4997F", "#A53460", "#99DEF9", "#284E37")) + 
  labs(x = "Abundance")

##Gwen

```

```{r}
##Tommy

speciescount <- species %>% 
  group_by(`Park Name`) %>% 
  summarize(total= n()) %>% 
  mutate(sum(total))

head(speciescount)

native <- speciesendanger %>% 
  filter(Nativeness == "Native") %>% 
  group_by(Nativeness) %>% 
  summarize(total = n())

head(native)

not_native <- speciesendanger %>% 
  filter(Nativeness != "Native") %>% 
  group_by(Nativeness) %>% 
  summarize(total = n()) 

head(not_native)

percent_native <- native %>% 
  full_join(not_native) %>% 
  mutate(percent = (total / sum(total))*100) 

head(percent_native)



```

```{r}
#Tommy

speciesgraph <- speciesendanger %>% 
 filter(!is.na(Abundance), Abundance != 'Unknown') %>% 
  group_by(Category, Abundance) %>% 
  summarize(total = n()) %>% 
  filter(total > 10) 
  
ggplot(speciesgraph) +
geom_col(aes(x = fct_reorder(Category, total), fill=factor(Abundance, levels = c("Rare", "Uncommon", "Occasional", "Common", "Abundant")), y=total), stat='identity') +
  labs(x = " ", y = "Total Count") +
    theme(panel.background = element_rect(fill = "white", colour = "white",size = 2, linetype = "solid"), panel.grid.major = element_line(size = 0.5, linetype = 'solid',colour = "white"), panel.grid.minor = element_line(size = 0.25, linetype = 'solid',colour = "white")) +
  guides(fill = guide_legend(title.position = "top", title = "Abundance"))+
  labs(title = "Plant and Animal Abundance in National Parks", subtitle = "What are the most abundant species in National Parks?") +
  theme(axis.text.y = element_text(color = "grey27"),axis.text.x = element_text(face = "italic", size = 10, color = "grey27", angle = 90), axis.ticks.y = element_blank(), legend.position = "right", legend.justification = "left", plot.background = element_rect(fill ="peachpuff"), legend.background = element_rect(fill ="white"), legend.text = element_text(face="italic", color = "grey27"), legend.title = element_text(color = "grey27", face = "bold"), plot.title = element_text(face = "bold", size = 17, hjust = 0.5, color = "grey27"), plot.subtitle = element_text(face = "italic", size = 10, hjust = 0.5, color = "grey27"), plot.caption = element_text(face = "italic", color = "grey27")) +
  theme(axis.title.y=element_text(colour="grey27", face = "bold")) +
   theme(axis.title.x=element_text(colour="grey27", face = "bold")) 


#we do not have a count of exactly how many of these unique species are in national parks, but from this graphic we can see that there are more unqique bird speices than any other category.

#total count is the total amount of distinct species in each category, so nonvascular plants make up only a handful of species, whereas there are nearly 2000 different types of birds 

```